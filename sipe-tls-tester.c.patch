--- src/core/sipe-tls-tester.c
+++ src/core/sipe-tls-tester.c.new
@@ -155,7 +155,7 @@
 		printf("received %d bytes from server\n", result);
 		record = g_new0(struct record, 1);
 		record->length  = result;
-		record->msg     = g_memdup(buffer, result);
+		record->msg     = g_memdup2(buffer, result);
 		length         += result;
 		fragments = g_slist_append(fragments, record);
 	}
